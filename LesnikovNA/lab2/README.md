# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

### 1. Предобработка изображения (BlobFromImage)

Перед подачей изображения в YOLO оно проходит следующие этапы предобработки:

- **Масштабирование**: Изображение масштабируется до заданного размера (по умолчанию, 512x512 пикселей).
- **Нормализация**: Значения пикселей нормализуются с использованием деления на коэффициент (например, `1/255`), чтобы привести данные к диапазону [0, 1].
- **Формирование blob**: Функция `cv.dnn.blobFromImage` преобразует изображение в специальный формат, подходящий для подачи в модель YOLO.

### 2. Обработка выходных данных сети

Модель YOLO возвращает набор предсказаний, каждое из которых содержит:

- **Координаты объекта**: Прямоугольная рамка, описывающая расположение объекта (x, y, ширина, высота).
- **Уверенность (confidence)**: Вероятность того, что объект присутствует в данном месте.
- **Класс объекта**: Идентификатор класса, соответствующий распознанному объекту (например, "машина", "человек").

### 3. Постобработка (NMS)

Для устранения дублирующихся рамок используется метод **Non-Maximum Suppression (NMS)**:

- Убираются детекции с уверенностью ниже заданного порога.
- Если несколько рамок сильно перекрываются, оставляется только та, которая имеет наивысшую уверенность.
- Результатом являются уникальные рамки для каждого объекта.

### 4. Визуализация результатов

Обнаруженные объекты отображаются на изображении или видео с использованием прямоугольных рамок (bounding boxes). Для каждого объекта указывается его класс и уверенность. Цвет рамки выбирается случайным образом для каждого класса.

## Аргументы командной строки

Для управления алгоритмом через командную строку поддерживаются следующие параметры:

- **`-i`**: Путь к входному изображению или видео. (Обязательный параметр)
- **`-w`**: Путь к файлу весов YOLO. (Обязательный параметр)
- **`-cfg`**: Путь к файлу конфигурации YOLO. (Обязательный параметр)
- **`-names`**: Путь к файлу с именами классов. (Обязательный параметр)
- **`-confThreshold`**: Порог уверенности для фильтрации объектов (по умолчанию: 0.5).
- **`-nmsThreshold`**: Порог для Non-Maximum Suppression (по умолчанию: 0.5).
- **`-inputSize`**: Размер изображения для входа в модель (по умолчанию: 512 512).